rule_id: MSCP RULE
title: The macOS system must monitor remote access methods and generate audit records
  when successful/unsuccessful attempts to access/modify privileges occur.
discussion: 'Frequently, an attacker that successfully gains access to a system has
  only gained access to an account with limited privileges, such as a guest account
  or a service account. The attacker must attempt to change to another user account
  with normal or elevated privileges in order to proceed. Without generating audit
  records that are specific to the security and mission needs of the organization,
  it would be difficult to establish, correlate, and investigate the events relating
  to an incident or identify those responsible for one.


  Audit records can be generated from various components within the information system
  (e.g., module or policy filter).


  '
check: /usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control
result: '[''Attempts to log in as another user are logged by way of the "lo" flag.'',
  '''', ''If "lo" is not listed in the result of the check, this is a finding.'']'
fix: 'To ensure the appropriate flags are enabled for auditing, run the following
  command:


  /usr/bin/sudo sed -i.bak ''/^flags/ s/$/,lo/'' /etc/security/audit_control; /usr/bin/sudo
  /usr/sbin/audit -s


  A text editor may also be used to implement the required updates to the "/etc/security/audit_control"
  file.'
references:
  srg:
  - SRG-OS-000032-GPOS-00013
  - SRG-OS-000462-GPOS-00206
  disa_stig:
  - APPL-12-001002
  cci:
  - CCI-000172
  - CCI-000067
macOS:
- '12'
tags:
- stig
severity: medium
