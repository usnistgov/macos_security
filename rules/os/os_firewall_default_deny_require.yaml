id: os_firewall_default_deny_require
title: "The macOS system must employ a deny-all, allow-by-exception firewall policy for allowing connections to other systems."
discussion: |
  A deny-all and allow-by-exception firewall policy MUST be employed for managing connections to other systems. 

  Organizations _MUST_ ensure the built-in packet filter firewall is configured correctly to employ the default deny rule.

  Failure to restrict network connectivity to authorized systems permits inbound connections from malicious systems. It also permits outbound connections that may facilitate the exfiltration of data.

  If you are using a third-party firewall solution, this setting does not apply. 
check: |
  /sbin/pfctl -a '*' -sr &> /dev/null | /usr/bin/grep -c "block drop in all"
result:
  integer: 1
fix: |
  NOTE: See the firewall supplemental which includes a script that has an example policy to implement this rule.
references:
  cce:
    - CCE-84756-6
  cci:
    - CCI-000366
    - CCI-002080
  800-53r4:
    - CM-6(b)
    - CA-3(5)
  srg:
    - SRG-OS-000480-GPOS-00231
  disa_stig:
    - AOSX-14-005051
macOS:
  - "10.15"
tags:
  - cnssi-1253
  - fisma-low
  - fisma-moderate
  - fisma-high
  - STIG
mobileconfig: false
mobileconfig_info: