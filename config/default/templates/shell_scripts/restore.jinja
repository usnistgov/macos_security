{% set check_tags = ["permanent", "inherent", "n_a", "not_applicable"] %}
{% if "supplemental" not in rule.rule_id and not (rule.tags | select("in", check_tags) | list) %}
{% if rule.default_state is not none and rule.default_state | length > 0 %}
  #####----- Rule: {{ rule.rule_id }} -----#####
  ## Addresses the following NIST 800-53 controls:
  {{ rule.references.nist.nist_800_53r5 | group_ulify if rule.references.nist.nist_800_53r5 is not none else "# * N/A" }}

  default_state_code="{{ rule.default_state | replace("\\\\", "\\") | replace('\"', '\\\"') | replace('$', '\$') | trim | safe }}"

  rule_default_state "{{ rule.rule_id }}" "$default_state_code"

{% endif %}
{% endif %}
