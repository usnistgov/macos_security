id: pwpolicy_max_lifetime_enforce
title: Restrict Maximum Password Lifetime to $ODV Days
discussion: "The system _MUST_ be configured to enforce a maximum password lifetime limit of $ODV days.\n\nThis rule ensures that users are forced to change their passwords frequently enough to prevent malicious users from gaining and maintaining access to the system.\n\nNOTE: To comply with Executive Order 14028, \u201CImproving the Nation's Cybersecurity\u201D, OMB M-22-09, \u201CMoving the U.S. Government Toward Zero Trust Cybersecurity Principles\u201D, and NIST SP-800-63b, \u201CDigital Identity Guidelines: Authentication and Lifecycle Management\u201D federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.\n"
references:
  nist:
    cce:
      macos_26:
        - CCE-95345-5
      macos_15:
        - CCE-94339-9
      macos_14:
        - CCE-92935-6
    800-53r5:
      - IA-5
    800-171r3:
      - 03.05.12
  disa:
    cci:
      - CCI-000199
      - CCI-004066
    srg:
      - SRG-OS-000076-GPOS-00044
      - SRG-OS-000775-GPOS-00230
    disa_stig:
      macos_26:
        - APPL-26-003008
      macos_15:
        - APPL-15-003008
      macos_14:
        - APPL-14-003008
    cmmc:
      - IA.L2-3.5.8
      - IA.L2-3.5.9
  cis:
    benchmark:
      macos_26:
        - 5.2.7 (level 1)
      macos_15:
        - 5.2.7 (level 1)
      macos_14:
        - 5.2.7 (level 1)
    controls_v8:
      - 5.3
platforms:
  macOS:
    '26.0':
      benchmarks:
        - name: cis_lvl1
        - name: cis_lvl2
        - name: disa_stig
          severity: medium
    '15.0':
      benchmarks:
        - name: cis_lvl1
        - name: cis_lvl2
        - name: disa_stig
          severity: medium
    '14.0':
      benchmarks:
        - name: cis_lvl1
        - name: cis_lvl2
        - name: disa_stig
          severity: medium
    enforcement_info:
      check:
        shell: /usr/bin/pwpolicy -getaccountpolicies 2> /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeExpiresEveryNDays"]/following-sibling::*[1]/text()' - | /usr/bin/awk '{ if ($1 <= $ODV ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq
        result:
          string: pass
    introduced: '10.7'
odv:
  hint:
    datatype: number
    description: Number of days, e.g. 60
    validation:
      min: 1
  recommended: 60
  cis_lvl1: 365
  cis_lvl2: 365
  stig: 60
tags:
  - cisv8
  - cnssi-1253_low
  - cnssi-1253_high
  - cmmc_lvl2
  - cnssi-1253_moderate
  - 800-171
  - 800-53r5_low
  - 800-53r5_moderate
  - 800-53r5_high
mobileconfig_info:
  - PayloadType: com.apple.mobiledevice.passwordpolicy
    PayloadContent:
      - maxPINAgeInDays: $ODV
ddm_info:
  declarationtype: com.apple.configuration.passcode.settings
  ddm_key: MaximumPasscodeAgeInDays
  ddm_value: $ODV
